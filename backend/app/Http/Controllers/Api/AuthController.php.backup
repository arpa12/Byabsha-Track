<?php

namespace App\Http\Controllers\Api;

use App\Http\Controllers\Controller;
use App\Http\Requests\LoginRequest;
use App\Http\Requests\RegisterRequest;
use App\Models\User;
use Illuminate\Http\JsonResponse;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\Hash;
use Illuminate\Validation\ValidationException;
















































































}    }        ]);            'user' => $request->user()->load('branch'),        return response()->json([    {    public function me(Request $request): JsonResponse     */     * Get authenticated user details    /**    }        ]);            'message' => 'Logged out successfully',        return response()->json([        $request->user()->currentAccessToken()->delete();    {    public function logout(Request $request): JsonResponse     */     * Logout user    /**    }        ]);            'token' => $token,            'user' => $user->load('branch'),            'message' => 'Login successful',        return response()->json([        $token = $user->createToken('auth_token')->plainTextToken;        $user->tokens()->delete();        // Delete old tokens        }            ], 403);                'message' => 'Your account has been deactivated. Please contact administrator.',            return response()->json([        if (!$user->is_active) {        }            ]);                'email' => ['The provided credentials are incorrect.'],            throw ValidationException::withMessages([        if (!$user || !Hash::check($request->password, $user->password)) {        $user = User::where('email', $request->email)->first();    {    public function login(LoginRequest $request): JsonResponse     */     * Login user    /**    }        ], 201);            'token' => $token,            'user' => $user,            'message' => 'User registered successfully',        return response()->json([        $token = $user->createToken('auth_token')->plainTextToken;        ]);            'is_active' => true,            'branch_id' => $request->branch_id,            'role' => $request->role ?? 'salesman',            'password' => Hash::make($request->password),            'email' => $request->email,            'name' => $request->name,        $user = User::create([    {    public function register(RegisterRequest $request): JsonResponse     */     * Register a new user    /**{class AuthController extends Controller